<!DOCTYPE html>
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<title>test.zenuml.mmd</title>
<meta name="generator" content="KF5::SyntaxHighlighting - Definition (Mermaid) - Theme (Breeze Dark)"/>
</head><body style="background-color:#232629;color:#cfcfc2"><pre>
<span style="font-weight:bold">zenuml</span>
    <span style="font-weight:bold">title</span><span style="color:#da4453"> Demo</span>

    <span style="color:#2980b9">Alice</span>

    <span style="color:#2980b9">@Database</span> <span style="color:#2980b9">Bob</span>
    
    <span style="color:#2980b9">J</span> <span style="color:#27aeae;font-weight:bold">as</span> <span style="color:#2980b9">John</span>

    <span style="color:#2980b9">A</span><span style="color:#27ae60">.</span><span style="color:#da4453">SyncMessage</span>
    <span style="color:#2980b9">A</span><span style="color:#27ae60">.</span><span style="color:#da4453">SyncMessage(with, parameters) </span><span style="color:#2980b9;font-weight:bold">{</span>
      <span style="color:#2980b9">B</span><span style="color:#27ae60">.</span><span style="color:#da4453">nestedSyncMessage()</span>
    <span style="color:#2980b9;font-weight:bold">}</span>

    <span style="font-weight:bold">new</span> <span style="color:#2980b9">A1</span>
    <span style="font-weight:bold">new</span> <span style="color:#2980b9">A2</span><span style="color:#27ae60">(</span><span style="color:#da4453">with, parameters</span><span style="color:#27ae60">)</span>

    <span style="color:#a43340">// 1. assign a variable from a sync message.</span>
    <span style="color:#2980b9">a = A</span><span style="color:#27ae60">.</span><span style="color:#da4453">SyncMessage()</span>

    <span style="color:#a43340">// 1.1. optionally give the variable a type</span>
    <span style="color:#2980b9">SomeType a = A</span><span style="color:#27ae60">.</span><span style="color:#da4453">SyncMessage()</span>

    <span style="color:#a43340">// 2. use return keyword</span>
    <span style="color:#2980b9">A</span><span style="color:#27ae60">.</span><span style="color:#da4453">SyncMessage() </span><span style="color:#2980b9;font-weight:bold">{</span>
      <span style="font-weight:bold">return</span><span style="color:#da4453"> result</span>
    <span style="color:#2980b9;font-weight:bold">}</span>

    <span style="color:#a43340">// 3. use @return or @reply annotator on an async message</span>
    <span style="color:#2980b9">@return</span>
    <span style="color:#2980b9">A</span><span style="color:#27ae60">-></span><span style="color:#2980b9">B</span><span style="color:#2980b9;font-weight:bold">:</span><span style="color:#da4453"> result</span>
    
    <span style="color:#2980b9">Client</span><span style="color:#27ae60">-></span><span style="color:#2980b9">A</span><span style="color:#27ae60">.</span><span style="color:#da4453">method() </span><span style="color:#2980b9;font-weight:bold">{</span>
      <span style="color:#2980b9">B</span><span style="color:#27ae60">.</span><span style="color:#da4453">method() </span><span style="color:#2980b9;font-weight:bold">{</span>
        <span style="color:#2980b9">if</span><span style="color:#27ae60">(</span><span style="color:#da4453">condition</span><span style="color:#27ae60">)</span> <span style="color:#2980b9;font-weight:bold">{</span>
          <span style="font-weight:bold">return</span><span style="color:#da4453"> x1</span>
          <span style="color:#a43340">// return early</span>
          <span style="color:#2980b9">@return</span>
          <span style="color:#2980b9">A</span><span style="color:#27ae60">-></span><span style="color:#2980b9">Client</span><span style="color:#2980b9;font-weight:bold">:</span><span style="color:#da4453"> x11</span>
        <span style="color:#2980b9;font-weight:bold">}</span>
      <span style="color:#2980b9;font-weight:bold">}</span>
      <span style="font-weight:bold">return</span><span style="color:#da4453"> x2</span>
    <span style="color:#2980b9;font-weight:bold">}</span>

    <span style="color:#a43340">// a comment on a message.</span>
    <span style="color:#a43340">// </span><span style="color:#3daee9">**</span><span style="color:#a43340">Markdown</span><span style="color:#3daee9">**</span><span style="color:#a43340"> is supported.</span>
    <span style="color:#2980b9">BookService</span><span style="color:#27ae60">.</span><span style="color:#da4453">getBook()</span>

    <span style="color:#2980b9">while</span><span style="color:#27ae60">(</span><span style="color:#da4453">true</span><span style="color:#27ae60">)</span> <span style="color:#2980b9;font-weight:bold">{</span>
      <span style="color:#2980b9">John</span><span style="color:#27ae60">-></span><span style="color:#2980b9">Alice</span><span style="color:#2980b9;font-weight:bold">:</span><span style="color:#da4453"> Great!</span>
    <span style="color:#2980b9;font-weight:bold">}</span>

    <span style="color:#2980b9">if</span><span style="color:#27ae60">(</span><span style="color:#da4453">is_sick</span><span style="color:#27ae60">)</span> <span style="color:#2980b9;font-weight:bold">{</span>
      <span style="color:#2980b9">Bob</span><span style="color:#27ae60">-></span><span style="color:#2980b9">Alice</span><span style="color:#2980b9;font-weight:bold">:</span><span style="color:#da4453"> Not so good :(</span>
    <span style="color:#2980b9;font-weight:bold">}</span> <span style="font-weight:bold">else</span> <span style="color:#2980b9;font-weight:bold">{</span>
      <span style="color:#2980b9">Bob</span><span style="color:#27ae60">-></span><span style="color:#2980b9">Alice</span><span style="color:#2980b9;font-weight:bold">:</span><span style="color:#da4453"> Feeling fresh like a daisy</span>
    <span style="color:#2980b9;font-weight:bold">}</span>

    <span style="font-weight:bold">opt</span> <span style="color:#2980b9;font-weight:bold">{</span>
      <span style="color:#2980b9">Bob</span><span style="color:#27ae60">-></span><span style="color:#2980b9">Alice</span><span style="color:#2980b9;font-weight:bold">:</span><span style="color:#da4453"> Thanks for asking</span>
    <span style="color:#2980b9;font-weight:bold">}</span>

    <span style="font-weight:bold">par</span> <span style="color:#2980b9;font-weight:bold">{</span>
      <span style="color:#2980b9">Alice</span><span style="color:#27ae60">-></span><span style="color:#2980b9">John</span><span style="color:#2980b9;font-weight:bold">:</span><span style="color:#da4453"> Hello guys!</span>
    <span style="color:#2980b9;font-weight:bold">}</span>
    
    <span style="font-weight:bold">try</span> <span style="color:#2980b9;font-weight:bold">{</span>
      <span style="color:#2980b9">Consumer</span><span style="color:#27ae60">-></span><span style="color:#2980b9">API</span><span style="color:#2980b9;font-weight:bold">:</span><span style="color:#da4453"> Book something</span>
      <span style="color:#2980b9">API</span><span style="color:#27ae60">-></span><span style="color:#2980b9">BookingService</span><span style="color:#2980b9;font-weight:bold">:</span><span style="color:#da4453"> Start booking process</span>
    <span style="color:#2980b9;font-weight:bold">}</span> <span style="font-weight:bold">catch</span> <span style="color:#2980b9;font-weight:bold">{</span>
      <span style="color:#2980b9">API</span><span style="color:#27ae60">-></span><span style="color:#2980b9">Consumer</span><span style="color:#2980b9;font-weight:bold">:</span><span style="color:#da4453"> show failure</span>
    <span style="color:#2980b9;font-weight:bold">}</span> <span style="font-weight:bold">finally</span> <span style="color:#2980b9;font-weight:bold">{</span>
      <span style="color:#2980b9">API</span><span style="color:#27ae60">-></span><span style="color:#2980b9">BookingService</span><span style="color:#2980b9;font-weight:bold">:</span><span style="color:#da4453"> rollback status</span>
    <span style="color:#2980b9;font-weight:bold">}</span>
</pre></body></html>
