<!DOCTYPE html>
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<title>test.zenuml.mmd</title>
<meta name="generator" content="KF5::SyntaxHighlighting - Definition (Mermaid) - Theme (Breeze Light)"/>
</head><body style="background-color:#ffffff;color:#1f1c1b"><pre>
<span style="font-weight:bold">zenuml</span>
    <span style="font-weight:bold">title</span><span style="color:#e31616"> Demo</span>

    <span style="color:#0057ae">Alice</span>

    <span style="color:#0057ae">@Database</span> <span style="color:#0057ae">Bob</span>
    
    <span style="color:#0057ae">J</span> <span style="color:#aa5500">as</span> <span style="color:#0057ae">John</span>

    <span style="color:#0057ae">A</span><span style="color:#006e28">.</span><span style="color:#e31616">SyncMessage</span>
    <span style="color:#0057ae">A</span><span style="color:#006e28">.</span><span style="color:#e31616">SyncMessage(with, parameters) </span><span style="color:#0057ae;font-weight:bold">{</span>
      <span style="color:#0057ae">B</span><span style="color:#006e28">.</span><span style="color:#e31616">nestedSyncMessage()</span>
    <span style="color:#0057ae;font-weight:bold">}</span>

    <span style="font-weight:bold">new</span> <span style="color:#0057ae">A1</span>
    <span style="font-weight:bold">new</span> <span style="color:#0057ae">A2</span><span style="color:#006e28">(</span><span style="color:#e31616">with, parameters</span><span style="color:#006e28">)</span>

    <span style="color:#607880">// 1. assign a variable from a sync message.</span>
    <span style="color:#0057ae">a = A</span><span style="color:#006e28">.</span><span style="color:#e31616">SyncMessage()</span>

    <span style="color:#607880">// 1.1. optionally give the variable a type</span>
    <span style="color:#0057ae">SomeType a = A</span><span style="color:#006e28">.</span><span style="color:#e31616">SyncMessage()</span>

    <span style="color:#607880">// 2. use return keyword</span>
    <span style="color:#0057ae">A</span><span style="color:#006e28">.</span><span style="color:#e31616">SyncMessage() </span><span style="color:#0057ae;font-weight:bold">{</span>
      <span style="font-weight:bold">return</span><span style="color:#e31616"> result</span>
    <span style="color:#0057ae;font-weight:bold">}</span>

    <span style="color:#607880">// 3. use @return or @reply annotator on an async message</span>
    <span style="color:#0057ae">@return</span>
    <span style="color:#0057ae">A</span><span style="color:#006e28">-></span><span style="color:#0057ae">B</span><span style="color:#0057ae;font-weight:bold">:</span><span style="color:#e31616"> result</span>
    
    <span style="color:#0057ae">Client</span><span style="color:#006e28">-></span><span style="color:#0057ae">A</span><span style="color:#006e28">.</span><span style="color:#e31616">method() </span><span style="color:#0057ae;font-weight:bold">{</span>
      <span style="color:#0057ae">B</span><span style="color:#006e28">.</span><span style="color:#e31616">method() </span><span style="color:#0057ae;font-weight:bold">{</span>
        <span style="color:#0057ae">if</span><span style="color:#006e28">(</span><span style="color:#e31616">condition</span><span style="color:#006e28">)</span> <span style="color:#0057ae;font-weight:bold">{</span>
          <span style="font-weight:bold">return</span><span style="color:#e31616"> x1</span>
          <span style="color:#607880">// return early</span>
          <span style="color:#0057ae">@return</span>
          <span style="color:#0057ae">A</span><span style="color:#006e28">-></span><span style="color:#0057ae">Client</span><span style="color:#0057ae;font-weight:bold">:</span><span style="color:#e31616"> x11</span>
        <span style="color:#0057ae;font-weight:bold">}</span>
      <span style="color:#0057ae;font-weight:bold">}</span>
      <span style="font-weight:bold">return</span><span style="color:#e31616"> x2</span>
    <span style="color:#0057ae;font-weight:bold">}</span>

    <span style="color:#607880">// a comment on a message.</span>
    <span style="color:#607880">// </span><span style="color:#3daee9">**</span><span style="color:#607880">Markdown</span><span style="color:#3daee9">**</span><span style="color:#607880"> is supported.</span>
    <span style="color:#0057ae">BookService</span><span style="color:#006e28">.</span><span style="color:#e31616">getBook()</span>

    <span style="color:#0057ae">while</span><span style="color:#006e28">(</span><span style="color:#e31616">true</span><span style="color:#006e28">)</span> <span style="color:#0057ae;font-weight:bold">{</span>
      <span style="color:#0057ae">John</span><span style="color:#006e28">-></span><span style="color:#0057ae">Alice</span><span style="color:#0057ae;font-weight:bold">:</span><span style="color:#e31616"> Great!</span>
    <span style="color:#0057ae;font-weight:bold">}</span>

    <span style="color:#0057ae">if</span><span style="color:#006e28">(</span><span style="color:#e31616">is_sick</span><span style="color:#006e28">)</span> <span style="color:#0057ae;font-weight:bold">{</span>
      <span style="color:#0057ae">Bob</span><span style="color:#006e28">-></span><span style="color:#0057ae">Alice</span><span style="color:#0057ae;font-weight:bold">:</span><span style="color:#e31616"> Not so good :(</span>
    <span style="color:#0057ae;font-weight:bold">}</span> <span style="font-weight:bold">else</span> <span style="color:#0057ae;font-weight:bold">{</span>
      <span style="color:#0057ae">Bob</span><span style="color:#006e28">-></span><span style="color:#0057ae">Alice</span><span style="color:#0057ae;font-weight:bold">:</span><span style="color:#e31616"> Feeling fresh like a daisy</span>
    <span style="color:#0057ae;font-weight:bold">}</span>

    <span style="font-weight:bold">opt</span> <span style="color:#0057ae;font-weight:bold">{</span>
      <span style="color:#0057ae">Bob</span><span style="color:#006e28">-></span><span style="color:#0057ae">Alice</span><span style="color:#0057ae;font-weight:bold">:</span><span style="color:#e31616"> Thanks for asking</span>
    <span style="color:#0057ae;font-weight:bold">}</span>

    <span style="font-weight:bold">par</span> <span style="color:#0057ae;font-weight:bold">{</span>
      <span style="color:#0057ae">Alice</span><span style="color:#006e28">-></span><span style="color:#0057ae">John</span><span style="color:#0057ae;font-weight:bold">:</span><span style="color:#e31616"> Hello guys!</span>
    <span style="color:#0057ae;font-weight:bold">}</span>
    
    <span style="font-weight:bold">try</span> <span style="color:#0057ae;font-weight:bold">{</span>
      <span style="color:#0057ae">Consumer</span><span style="color:#006e28">-></span><span style="color:#0057ae">API</span><span style="color:#0057ae;font-weight:bold">:</span><span style="color:#e31616"> Book something</span>
      <span style="color:#0057ae">API</span><span style="color:#006e28">-></span><span style="color:#0057ae">BookingService</span><span style="color:#0057ae;font-weight:bold">:</span><span style="color:#e31616"> Start booking process</span>
    <span style="color:#0057ae;font-weight:bold">}</span> <span style="font-weight:bold">catch</span> <span style="color:#0057ae;font-weight:bold">{</span>
      <span style="color:#0057ae">API</span><span style="color:#006e28">-></span><span style="color:#0057ae">Consumer</span><span style="color:#0057ae;font-weight:bold">:</span><span style="color:#e31616"> show failure</span>
    <span style="color:#0057ae;font-weight:bold">}</span> <span style="font-weight:bold">finally</span> <span style="color:#0057ae;font-weight:bold">{</span>
      <span style="color:#0057ae">API</span><span style="color:#006e28">-></span><span style="color:#0057ae">BookingService</span><span style="color:#0057ae;font-weight:bold">:</span><span style="color:#e31616"> rollback status</span>
    <span style="color:#0057ae;font-weight:bold">}</span>
</pre></body></html>
